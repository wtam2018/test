# Install the app dependencies in a full Node docker image
FROM node:12
USER node

COPY . /project/

# Removing node_modules
RUN rm -rf /project/node_modules

# Install user-app dependencies
WORKDIR /project
COPY package.json .
RUN npm install --production 

# Copy the dependencies into a slim Node docker image
FROM node:12-slim
USER node

# Copy project with dependencies
COPY  --from=0 /project /project
RUN chown node:node /project

WORKDIR /project

ENV NODE_ENV production


CMD ["npm", "start"]
